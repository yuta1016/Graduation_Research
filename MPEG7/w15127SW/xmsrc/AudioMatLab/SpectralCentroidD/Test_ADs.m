%% File Name: Test_ADs.m
%%
%% Copyright (c), IME, All Rights Reserved
%%
%% Author: Dong Yan Huang
%% Version: 1.0  Time: 28 August 2000 (N3489)
%% Last modified: 27 Mar 2001 (N3704)


%path(path,'C:/dongyanbackup/research/data/Sqam');
%path(path,'C:/dongyanbackup/research/data/Paris5');
%path(path,'C:/dongyanbackup/research/data/phoneme');
path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/ScalableSeries');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/AIC');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/CTmelody');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/CTtimbre');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/Timbre');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/Melody');
%path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/Segment');
path(path,'C:/dongyanbackup/standards/mpeg/mpeg7/ADs');

%path(path,'C:/dongyan/data/Sqam');
%path(path,'C:/dongyan/data/Paris5');
%path(path,'C:/dongyan/data/phoneme');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/ScalableSeries');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/AIC');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/CTmelody');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/CTtimbre');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/Timbre');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/Melody');
%path(path,'C:/dongyan/demos/mpeg7demos/AudioDescriptors/Segment');

clear all;

aufileName = 'Svega.pcm';
weight =[];% [0  0  0  0  0  0  0  0  0  0  1  1  1  1  1  1  0  0  ...
%      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  ...
%      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  ...
%      1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  0  0  1  1  ...
%      1  1  1  1  1  0  0  0  0  1  1  1  1  1  1  0  0  0  0  ...
%      1  1  1  1  1  0];
%%
%% Audio Samples and information such like total samples number(totalSampleNum), sampling rate(Fs), 
%% bit number per sample (bitNum) and channel number (channelNum)
%%
if 0
[audata, totalSampleNum, SamplingRate, bitNum, channelNum] = AudioSamples(aufileName);
end
%%
%% AudioWaveformEnvelopeType
%%
if 1
auData = [10  10  10  10  10  10  10  10  10  10  14  17  19  18 ...
      15  11  10  10  13  20  27  32  33  30  25  18  14  14 ...
      20  30  39  46  48  43  35  25  19  20  27  40  52  61 ...
      63  56  45  32  25  25  34  50  65  76  77  69  54  39 ...
      30  30  42  60  78  90  92  82  65  46  35  36  49  70 ...
      91  99  99  95  75  54  41  41  56  80  99  99  99  99 ...
      84  61  46  46  63  90  99  99  99  99  94  68  51  52  70  99];

scaledRatio = 32;
rescaledFactor = 1;
scalingRatio = scaledRatio*rescaledFactor;
%scalingRatio = [50 1 45];
%elementNum = [1 5 1];
elementNum = 4;
totalSampleNum = 100;
if length(weight)==0
   weight_flag = 0;
else
   weight_flag = 1;
end

write_flag = 1; % write_flag = 1 (write Description in XML file)
                % write_flag = 0 (not write Description in XML file)
                % write_flag = 2 (write values in XML file)
rootFirst = 1;

[Raw, maxValues, minValues,rootFirstValues,varianceScalewiseValues] = AudioWaveformEnvelope(auData,totalSampleNum,scalingRatio,elementNum,weight_flag, weight, write_flag,rootFirst);
end
%%
%% AudioSpectrumEnvelopeType
%%

auData = [0.0859 -0.0234 -0.0977 -0.1289 -0.1289 -0.0508 0.0488 0.0742 0.0664 0.0547 -0.0068  -0.0332 ...
   -0.0117 -0.0186 -0.0186  0.0039  0.0044  0.0039   0.0313   0.0352   0.0022  -0.0166  -0.0430  -0.0859 ...
   -0.0508  0.0127  0.0410  0.1367  0.3867  0.4648  0.1445  0.0166 -0.2148 -0.6211 -0.3711 -0.1758 -0.1367 ...
    0.1016  0.1367  0.0625  0.0938  0.1758   0.1758   0.0938  -0.0586  -0.2070  -0.3711  -0.3242  -0.0137 ...
    0.1172   0.2773   0.3242   0.1211   0.0063  -0.0254  -0.0410  -0.0410 -0.0527 -0.1133 -0.1836 -0.1289 ...
    0.0469  0.1836  0.2773  0.3086  0.1211 -0.0742 -0.1602 -0.2305 -0.1836 -0.0742 -0.0293 -0.0005  0.0586 ...
    0.0898  0.0898  0.1172  0.0469 -0.0781 -0.1289 -0.1445 -0.1133  0.0088  0.0977  0.0859  0.0703  0.0273 ...
   -0.0449  -0.0449  -0.0146  -0.0225  -0.0088   0.0156   0.0088   0.0205   0.0410   0.0166  -0.0215  -0.0430 ...
   -0.0664  -0.0586   0.0039   0.0586   0.0859    0.2461    0.4805    0.3086    0.0176   -0.0449   -0.4805 ...
   -0.5586   -0.2148   -0.1836    0.0029    0.1914    0.1133    0.0703    0.1289    0.1680    0.1172    0.0039 ...
   -0.1445   -0.2930   -0.3867   -0.1445    0.0898  0.1992   0.3555   0.2383  0.0352 -0.0225   -0.0664  -0.0664 ...
   -0.0586  -0.0742  -0.1445  -0.1523  -0.0156   0.1367   0.2383   0.2930   0.1992  -0.0049  -0.1289  -0.2070 ...
   -0.2148  -0.1133  -0.0264   0.0027   0.0527   0.0898   0.0781   0.0977   0.0664  -0.0469  -0.1172  -0.1289 ...
   -0.1211  -0.0391   0.0742   0.0859   0.0625   0.0430  -0.0254  -0.0449  -0.0083  -0.0020  -0.0032   0.0186 ...
    0.0039  -0.0049  0.0225  0.0098   -0.0137   -0.0371   -0.0469   -0.0586   -0.0313    0.0156    0.0508 ...
    0.1055    0.2930    0.5273    0.2773    0.0049   -0.0938   -0.5898   -0.5586   -0.1914   -0.1602    0.0703 ...
    0.1992    0.0820    0.0625    0.1367    0.1680    0.1211   -0.0205   -0.1836   -0.3555   -0.4023   -0.0781 ...
    0.1289    0.2617    0.3867    0.1758   -0.0029   -0.0527   -0.0898   -0.0586   -0.0469   -0.0859   -0.1602 ...
   -0.1367    0.0273    0.1836    0.2773    0.3086    0.1367   -0.0625   -0.1680   -0.2305   -0.1758   -0.0781 ...
   -0.0137    0.0022    0.0527   0.0781    0.0820    0.1133    0.0449   -0.0664   -0.1211   -0.1367   -0.1016 ...
    0.0068   0.0977    0.0703    0.0449    0.0015   -0.0586   -0.0391    0.0034    0.0034    0.0137    0.0273 ...
    0.0027    0.0098    0.0332   -0.0010   -0.0352   -0.0488   -0.0664   -0.0625   -0.0083    0.0586    0.0820 ...
    0.1523    0.3867    0.4961    0.1367   -0.0176   -0.2227   -0.6836   -0.4023   -0.1523   -0.1211    0.1758 ...
    0.1836    0.0625    0.0898    0.1523    0.1367    0.0586   -0.0859   -0.2461   -0.4023   -0.2930    0.0430 ...
    0.1680    0.3398    0.3555    0.0781   -0.0225   -0.0781   -0.0977   -0.0625   -0.0586   -0.1172   -0.1602 ...
   -0.0703    0.1055    0.2227    0.3086    0.2617    0.0391   -0.1055   -0.1992   -0.2227   -0.1289   -0.0430 ...
   -0.0054    0.0186    0.0703    0.0703    0.0938    0.0977   -0.0088   -0.0977   -0.1289   -0.1289   -0.0664 ...
    0.0527    0.0898    0.0566    0.0430   -0.0225   -0.0527   -0.0137   -0.0020    0.0002    0.0176    0.0166 ...
    0.0032    0.0215    0.0176   -0.0234   -0.0469   -0.0488   -0.0586   -0.0205    0.0352    0.0566    0.1016 ...
    0.2617    0.4961    0.2930    0.0166   -0.0820   -0.5586   -0.5586   -0.2070   -0.1680    0.0664    0.2148 ...
    0.0859    0.0586    0.1289    0.1523    0.1133   -0.0093   -0.1758   -0.3555   -0.3867   -0.0781    0.1211 ...
    0.2773    0.3867    0.1680   -0.0012   -0.0586   -0.0938   -0.0586   -0.0410   -0.0898   -0.1602   -0.1289 ...
    0.0352    0.1836    0.2773    0.3086    0.1211   -0.0703   -0.1758   -0.2305  -0.1680   -0.0586   -0.0176  ...
    0.0010    0.0586    0.0664    0.0820    0.1211    0.0371   -0.0703   -0.1172   -0.1367   -0.1016    0.0195 ...
    0.0859    0.0625    0.0488   -0.0059   -0.0586   -0.0244    0.0068    0.0022    0.0264    0.0146   -0.0103 ...
    0.0107    0.0146   -0.0022   -0.0264   -0.0469   -0.0742   -0.0430    0.0293    0.0742    0.1367    0.3398 ...
    0.5273    0.2070   -0.0146   -0.1445   -0.6211   -0.4648   -0.1758   -0.1758    0.1133    0.1836    0.0703 ...
    0.0977    0.1602    0.1602    0.0703   -0.0625   -0.2148   -0.3867   -0.3242   -0.0078    0.1211    0.3086 ...
    0.3555    0.1133    0.0225   -0.0547   -0.0898   -0.0566   -0.0664   -0.1211   -0.1758   -0.0859    0.0781 ...
    0.1992    0.3086    0.2773    0.0742   -0.0664   -0.1758   -0.2305   -0.1445   -0.0664   -0.0410    0.0039 ...
    0.0703    0.0664    0.1016    0.1133    0.0032   -0.0781   -0.1133   -0.1289   -0.0781    0.0430    0.0742 ...
    0.0566    0.0508   -0.0244   -0.0566   -0.0176   -0.0137   -0.0012    0.0313    0.0137    0.0010    0.0166 ...
    0.0073   -0.0146   -0.0293   -0.0430   -0.0313    0.0117    0.0391    0.0547    0.1016    0.2773    0.4961 ...
    0.2070    0.0037   -0.1289   -0.6523   -0.4492   -0.1758   -0.1680    0.1523    0.1836    0.0586    0.0781 ...
    0.1211    0.1445    0.0977   -0.0273   -0.1914   -0.3867   -0.3086   -0.0225    0.0977    0.3398    0.3555 ...
    0.1016    0.0244   -0.0820   -0.0938   -0.0391   -0.0410   -0.0938   -0.1680   -0.0938    0.0488    0.1680 ...
    0.3242    0.2930    0.0625   -0.0664   -0.1992   -0.2617   -0.1289   -0.0469   -0.0215    0.0273    0.0664 ...
    0.0410    0.0898   0.1133   -0.0005   -0.0566   -0.1055   -0.1445   -0.0742    0.0410    0.0703    0.0664 ...
    0.0586   -0.0391   -0.0625   -0.0205   -0.0234    0.0117    0.0469    0.0166    0.0012    0.0225   -0.0078 ...
   -0.0273   -0.0273   -0.0527   -0.0430   -0.0022    0.0332    0.0820    0.2305    0.4961    0.3867    0.0527 ...
   -0.0371   -0.4648   -0.6211  -0.2383   -0.2070         0    0.2070    0.0898    0.0781    0.1367    0.1758 ...
    0.1289    0.0127   -0.1445   -0.3555   -0.4023   -0.1289    0.0547    0.2383    0.4023    0.1914    0.0625 ...
   -0.0112   -0.0938   -0.0527   -0.0566   -0.0977   -0.1758   -0.1445    0.0029    0.1289    0.2773    0.3398 ...
    0.1602   -0.0012   -0.1289   -0.2305   -0.1836   -0.0938   -0.0547   -0.0186    0.0488    0.0586    0.0859 ...
    0.1289    0.0508   -0.0391   -0.0977   -0.1367   -0.1133   -0.0059    0.0625    0.0625    0.0625    0.0044 ...
   -0.0508   -0.0254   -0.0117   -0.0117    0.0225    0.0176   -0.0083    0.0166    0.0098   -0.0156   -0.0117 ...
   -0.0293   -0.0469   -0.0254    0.0127    0.0469    0.1445    0.3711    0.4961    0.2070   -0.0098   -0.2148 ...
   -0.6523  -0.4180   -0.1836   -0.1523    0.1523    0.1445    0.0566    0.1094    0.1758    0.0859   -0.0586 ...
   -0.2617   -0.4336   -0.2930   -0.0088    0.1289    0.3711    0.3086    0.0859    0.0391   -0.0664   -0.0664 ...
   -0.0352   -0.0742   -0.1445   -0.1914   -0.0742    0.0742    0.2148    0.3398    0.2461    0.0547   -0.0527 ...
   -0.1992   -0.1992   -0.1016   -0.0820   -0.0508   -0.0037    0.0352    0.0586    0.1367    0.1133    0.0088 ...
   -0.0527   -0.1367   -0.1367   -0.0527    0.0547    0.0547    0.0166   -0.0449   -0.0234   -0.0029   -0.0024 ...
    0.0205   0.0137   -0.0117    0.0103    0.0225    0.0049    0.0005   -0.0186   -0.0508   -0.0293   -0.0015 ...
    0.0166    0.0586    0.1367    0.3555    0.4805    0.1523    0.0034   -0.2383   -0.6523   -0.3555   -0.2070 ...
   -0.1211    0.1914    0.1211    0.0586    0.1055    0.1445    0.1523    0.0781   -0.0625   -0.4180   -0.2461 ...
   -0.0059    0.1445    0.3867    0.2773    0.0898    0.0273   -0.1016   -0.0664   -0.0410   -0.0664   -0.1367 ...
   -0.1758   -0.0586    0.0703    0.2227    0.3398    0.2305    0.0527   -0.0742   -0.2227   -0.1992   -0.0977 ...
   -0.0527   -0.0313    0.0205    0.0254    0.0391    0.1211    0.0859    0.0063   -0.0547   -0.1289   -0.1367 ...
   -0.0469    0.0391    0.0586    0.0703    0.0186   -0.0449   -0.0293   -0.0098    0.0039    0.0293    0.0244 ...
   -0.0166   -0.0037    0.0146   -0.0117   -0.0059   -0.0371   -0.0703   -0.0332    0.0037    0.0586    0.1445 ...
    0.3398    0.4961   0.2617    0.0010   -0.1523   -0.6211   -0.4961   -0.1914    0.1094    0.1680    0.0664 ...
    0.1211    0.1680    0.1680    0.0898   -0.0469   -0.2305   -0.4180   -0.3086   -0.0391    0.1016    0.3398 ...
    0.3398    0.1133    0.0625   -0.0547   -0.0859   -0.0449   -0.0820   -0.1367   -0.1836   -0.0820    0.0586 ...
    0.1992    0.3398    0.2617    0.0742   -0.0293   -0.1914   -0.2148   -0.1172   -0.0820   -0.0430   -0.0017 ...
    0.0410    0.0410    0.1211    0.1094    0.0137   -0.0332   -0.1211   -0.1367   -0.0625    0.0186    0.0488 ...
    0.0527    0.0234   -0.0469   -0.0293   -0.0088    0.0049    0.0293    0.0293    0.0012   -0.0156    0.0137 ...
   -0.0010         0   -0.0127   -0.0625   -0.0547   -0.0332    0.0293    0.1016    0.2305    0.4648    0.4336 ...
    0.0859   -0.0625   -0.3867   -0.6523   -0.2773   -0.0547    0.1914    0.0859    0.1445    0.1836    0.1367 ...
    0.0137   -0.1445   -0.3398   -0.4023   -0.1602    0.0527    0.2227    0.4023    0.2148    0.0742    0.0088 ...
   -0.0977   -0.0586   -0.0664   -0.1172   -0.1758   -0.1445    0.0020    0.1367    0.2773    0.3242    0.1523 ...
    0.0112   -0.1133   -0.2227   -0.1523   -0.0898   -0.0586   -0.0254    0.0264    0.0371    0.0781    0.1289 ...
    0.0488   -0.0137   -0.0820   -0.1367   -0.0977   -0.0127    0.0449    0.0488    0.0469   -0.0146   -0.0430 ...
   -0.0117   -0.0088    0.0059    0.0273    0.0234   -0.0020    0.0137    0.0015   -0.0293   -0.0225   -0.0430 ...
   -0.0410   -0.0112    0.0186    0.0625    0.1211    0.3398    0.4961    0.2617    0.0098   -0.1680   -0.6211 ...
   -0.4961   -0.1992   -0.1758    0.1367    0.1758    0.0703    0.1016    0.1445    0.1680    0.0859   -0.0332 ...
   -0.2383   -0.4336   -0.3086   -0.0430    0.1211    0.3711    0.3555    0.1133    0.0449   -0.0859   -0.0977 ...
   -0.0469   -0.0664   -0.1289   -0.1836   -0.0781    0.0527    0.2070    0.3398    0.2461    0.0664   -0.0469 ...
   -0.2148   -0.2070   -0.1016   -0.0664   -0.0254    0.0059    0.0273    0.0332    0.1172    0.0977    0.0146 ...
   -0.0352   -0.1289   -0.1289    0.0273    0.0566    0.0586    0.0176   -0.0488   -0.0293   -0.0176   -0.0007 ...
    0.0254    0.0186    0.0007    0.0010    0.0215   -0.0022   -0.0015   -0.0205   -0.0625   -0.0566   -0.0332 ...
    0.0313    0.0859    0.1992    0.4180   0.4648   0.1367     -0.0273   -0.3086   -0.6836  -0.3398   -0.2148 ...
    0.0245 0.0354 0.0567 0.567 0.345 0.568 0.0389 -0.0977];
auData = auData';

totalSampleNum = 1024;
samplingRate = 32000;
loEdge = 62.5;
hiEdge = 16000;
resolution = 1; % 1/16, 1 coef f < 62.5, 16*8 coefs, 1 coef f > 16000, total 130 coefs  
						% 1/8, 1 coef f < 62.5, 8*8 coefs, 1 coef f > 16000, total 66 coefs
                  % 1/4, 1 coef f < 62.5, 4*8 coefs, 1 coef f > 16000, total 34 coefs
                  % 1/2, 1 coef f < 62.5, 2*8 coefs, 1 coef f > 16000, total 18 coefs
                  % 1, 1 coef f < 62.5, 8 coefs, 1 coef f > 16000, total 10 coefs
                  % 2, 1 coef f < 62.5, 4 coefs, 1 coef f > 16000, total 6 coefs
                  % 4, 1 coef f < 62.5, 2 coefs, 1 coef f > 16000, total 4 coefs
                  % 8, 1 coef f < 62.5, 1 coefs, 1 coef f > 16000, total 4 coefs 
framePeriod = 0.016; 

Spectrum_SeriesOfVector = AudioSpectrumEnvelope(auData,totalSampleNum,samplingRate,loEdge,hiEdge,resolution,framePeriod);

%%
%% AudioPowerType
%%
totalSampleNum = 1024;
scaledRatio = 32;
rescaledFactor = 1;
scalingRatio = scaledRatio*rescaledFactor;
elementNum = 32;
weight =[];
AudioPower_SeriesOfScalar = AudioPower(auData,totalSampleNum,samplingRate,scalingRatio,elementNum,weight);
%%
%% AudioSpectrumCentroidType
%%
totalSampleNum = 1024;
samplingRate = 32000;
framePeriod = 0.016; 
SpectrumCentroid_SeriesOfVector = AudioSpectrumCentroid(auData,totalSampleNum,samplingRate,framePeriod);
%%
%% AudioSpectrumSpreadType
%%

totalSampleNum = 1024;
samplingRate = 32000;
framePeriod = 0.016; 
SpectrumSpread_SeriesOfVector = AudioSpectrumSpread(auData,totalSampleNum,samplingRate,framePeriod);

%%
%% AudioFundamentalFrequencyType
%%


   
totalSampleNum = 1024;
samplingRate = 8000;
framePeriod = 0.016; 
loLimit = 25 ;
hiLimit = 4000 ;
samplingRate = 8000;
 

[FundFreq_SeriesOfScalar,weight] = AudioFundamentalFrequency(auData,totalSampleNum,samplingRate,loLimit,hiLimit,framePeriod);
%%
%% AudioHarmonicityType
%%
totalSampleNum = 512;

auData = auData(1:totalSampleNum)';
samplingRate = 8000;
[HarmonicRatio_SeriesOfVector,upperLmitOfHarmonicity] = AudioHarmonicity(auData,totalSampleNum,samplingRate);

